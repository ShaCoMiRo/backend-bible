# 교착 상태

1. [교착 상태(Deadlock)란?](#교착-상태deadlock란)
2. [교착 상태의 발생 조건](#교착-상태의-발생-조건)
3. [교착 상태 해결법](#교착-상태-해결법)
4. [참고 자료](#참고-자료)

## 교착 상태(Deadlock)란?

> 둘 이상의 서로 다른 프로세스/스레드가 서로가 이미 점유하고 있는 자원을 기다릴 때, 무한 대기에 빠지는 상황.

한정된 자원을 여러 곳에서 사용하려고 할 때 발생하는 문제로, 자원을 무한정 기다리게 되어 다음 작업을 진행하지 못하는 상태를 말한다.

간단한 예시를 들자면 다음과 같다.

- 프로세스1(P1)과 프로세스2(P2)가 모두 자원1(R1), 자원2(R2)를 얻어야 한다.
- t1 : P1이 R1을 얻음 / P2가 R2를 얻음
- t2 : P1은 R2를 기다림 / P2는 R1을 기다림

이처럼 현재 서로 원하는 자원이 상대방에게 할당되어 있어서 두 프로세스는 무한정 wait 상태에 빠지게 된다. 이러한 상황을 **교착 상태**(Deadlock)이라고 부른다.

## 교착 상태의 발생 조건

교착 상태는 다음 4가지 조건이 동시에 성립할 때 발생하며, 4가지 조건 중 하나라도 성립하지 않는다면 교착 상태를 해결할 수 있다.

- 상호 배제(Mutual Exclusion)
  - 동시에 하나의 프로세스/스레드만 자원을 점유할 수 있다.
  - 다른 프로세스/스레드가 자원을 사용하려면 자원이 방출될 때까지 기다려야 한다.
- 점유 대기(Hold and Wait)
  - 프로세스/스레드가 자원을 점유한 상태에서 다른 프로세스/스레드에 점유한 자원을 추가로 기다리는 상태이다.
- 비선점(No Preemption)
  - 다른 프로세스/스레드가 사용중인 자원을 강제로 선점할 수 없는 상황이다.
  - 자원을 점유한 프로세스/스레드에 의해서만 자원이 방출된다.
- 순환 대기(Circular Wait)
  - 대기 중인 프로세스/스레드들이 순환 형태로 자원을 대기하는 상황이다.

## 교착 상태 해결법

교착 상태의 해결 방법에는 무시, 예방, 회피, 탐지-회복의 4가지 방법이 있다.

| 기법      | 설명                                                                                           | 비고                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| --------- | ---------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 무시      | 교착 상태 발생 확률이 낮은 시스템에서 아무런 조치도 취하지 않고 교착 상태를 무시하는 방법이다. | 무시 기법은 **시스템 성능 저하가 없다**는 큰 장점이 있다. 현대 시스템에선 **교착 상태가 드물고, 해결 비용이 크기 때문에** 무시 방법이 많이 사용된다.                                                                                                                                                                                                                                                                                                                                  |
| 예방      | 교착 상태의 발생 조건 중 하나를 제거함으로써 해결하는 방법이다.                                | <ul><li>상호 배제 부정 : 여러 프로세스/스레드가 공유 자원을 사용하도록 허용</li><li>점유 대기 부정 : 프로세스/스레드 실행 전 필요한 모든 자원 할당</li><li>비선점 부정 : 자원을 점유중인 프로세스가 다른 자원을 요구시 점유중인 자원을 반납한 후 요구한 자원을 사용하기 위해 대기</li><li>순환 대기 부정 : 자원에 고유 번호를 할당한 후 번호 순서대로 자원을 요구</li></ul> 위 방법들 중 순환 대기 부정이 현실적으로 가능한 예방 기법이며, **자원 사용의 효율성이 떨어지고 비용이 크다**는 단점이 있다. |
| 회피      | 교착 상태가 발생하지 않도록 미리 예측하여 회피하는 방법이다.                                   | 자원 할당 그래프 알고리즘, 은행원 알고리즘 등을 사용하여 자원을 할당하는 방식으로 교착 상태를 회피한다.<br> 프로세스/스레드가 앞으로 요청할 자원들에 대한 정보를 통해 순환 대기 상태에 빠지지 않도록 자원을 할당한다.                                                                                                                                                                                                                                                                 |
| 탐지-회복 | 시스템 검사를 통해 교착 상태의 발생을 탐지하고, 이를 회복시키는 방법이다.                      | 자원 요청시마다 탐지 알고리즘을 실행하고, 교착 상태를 발견하면 프로세스/스레드의 종료, 자원 해제 작업을 수행해야 하므로 **자원 사용의 효율성이 떨어지고 비용이 크다.**                                                                                                                                                                                                                                                                                                                |


  


## 참고 자료

- [교착 상태](<https://github.com/WooVictory/Ready-For-Tech-Interview/blob/master/Operating%20System/%EA%B5%90%EC%B0%A9%EC%83%81%ED%83%9C(DeadLock).md>)
